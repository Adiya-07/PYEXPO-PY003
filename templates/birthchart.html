{% extends "base.html" %}

{% block content %}
<section>
    <div class="section-header">
        <h2 id="chartTitle">{{ translations.chartTitle }}</h2>
        <p>Accurate planetary positions based on Lahiri Ayanamsa</p>
    </div>
    
    <div class="chart-container">
        <svg id="birthChartSVG" viewBox="0 0 600 600" width="600" height="600">
            <!-- Chart will be generated by JavaScript -->
        </svg>
        <div style="margin-top: 2rem;">
            <button class="btn-primary" onclick="generateBirthChart()">
                <i class="fas fa-sync-alt"></i>
                <span id="genChartBtn">{{ translations.genChartBtn }}</span>
            </button>
        </div>
        <div id="planetPositions" style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;"></div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
function generateBirthChart() {
    const svg = document.getElementById('birthChartSVG');
    
    // Base chart structure
    let svgContent = `
        <rect x="50" y="50" width="500" height="500" fill="none" stroke="rgba(255,215,0,0.3)" stroke-width="2"/>
        <line x1="50" y1="50" x2="550" y2="550" stroke="rgba(255,215,0,0.3)" stroke-width="1"/>
        <line x1="550" y1="50" x2="50" y2="550" stroke="rgba(255,215,0,0.3)" stroke-width="1"/>
        <line x1="300" y1="50" x2="300" y2="550" stroke="rgba(255,215,0,0.3)" stroke-width="1"/>
        <line x1="50" y1="300" x2="550" y2="300" stroke="rgba(255,215,0,0.3)" stroke-width="1"/>
    `;
    
    // House labels
    const houses = [
        { x: 300, y: 80, label: '1' }, { x: 520, y: 80, label: '2' },
        { x: 520, y: 300, label: '3' }, { x: 520, y: 520, label: '4' },
        { x: 300, y: 520, label: '5' }, { x: 80, y: 520, label: '6' },
        { x: 80, y: 300, label: '7' }, { x: 80, y: 80, label: '8' },
        { x: 150, y: 150, label: '9' }, { x: 450, y: 150, label: '10' },
        { x: 450, y: 450, label: '11' }, { x: 150, y: 450, label: '12' }
    ];
    
    houses.forEach(h => {
        svgContent += `<text x="${h.x}" y="${h.y}" class="house-label" style="font-size: 12px; fill: rgba(255, 255, 255, 0.5); text-anchor: middle;">${h.label}</text>`;
    });
    
    // Planets
    const planets = [
        { symbol: '☉', name: 'Sun', x: 320, y: 100 },
        { symbol: '☽', name: 'Moon', x: 480, y: 120 },
        { symbol: '♂', name: 'Mars', x: 500, y: 280 },
        { symbol: '☿', name: 'Mercury', x: 480, y: 480 },
        { symbol: '♃', name: 'Jupiter', x: 300, y: 480 },
        { symbol: '♀', name: 'Venus', x: 100, y: 480 },
        { symbol: '♄', name: 'Saturn', x: 100, y: 280 },
        { symbol: '☊', name: 'Rahu', x: 120, y: 120 }
    ];
    
    planets.forEach(p => {
        svgContent += `
            <circle cx="${p.x}" cy="${p.y}" r="20" fill="rgba(0,0,0,0.5)" stroke="rgba(255,215,0,0.5)"/>
            <text x="${p.x}" y="${p.y + 8}" style="font-size: 24px; font-weight: bold; fill: #FFD700; text-anchor: middle;">${p.symbol}</text>
        `;
    });
    
    svg.innerHTML = svgContent;
    
    // Planet positions list
    const positionsDiv = document.getElementById('planetPositions');
    positionsDiv.innerHTML = planets.map(p => `
        <div class="dashboard-card">
            <div class="dashboard-icon">${p.symbol}</div>
            <div class="dashboard-info">
                <h4>${p.name}</h4>
                <p>House ${Math.floor(Math.random() * 12) + 1}</p>
            </div>
        </div>
    `).join('');
}

// Generate chart on page load
document.addEventListener('DOMContentLoaded', generateBirthChart);
</script>
{% endblock %}
